<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>

<BorderPane styleClass="root" stylesheets="@../assets/staff-transaction.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.oop.stockflow.controller.StaffTransactionController">
    <!-- Top Navigation Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="navbar">
            <padding>
                <Insets bottom="16" left="24" right="24" top="16" />
            </padding>

            <!-- Logo Section -->
            <HBox alignment="CENTER_LEFT" spacing="12" HBox.hgrow="NEVER">
                <Group>
                    <SVGPath content="M30 0C34.4183 0 38 3.58172 38 8V32C38 36.4183 34.4183 40 30 40H8C3.58172 40 0 36.4183 0 32V8C0 3.58172 3.58172 0 8 0H30Z" fill="#2563EB" scaleX="1.3" scaleY="1.3" />
                    <SVGPath content="M30 0C34.4183 0 38 3.58172 38 8V32C38 36.4183 34.4183 40 30 40H8C3.58172 40 0 36.4183 0 32V8C0 3.58172 3.58172 0 8 0H30Z" fill="transparent" scaleX="1.3" scaleY="1.3" stroke="#E5E7EB" />
                    <SVGPath content="M30.25 34H7.75V6H30.25V34Z" fill="transparent" scaleX="1.3" scaleY="1.3" stroke="#E5E7EB" />
                    <SVGPath content="M7.75 27.4063V16.2723C7.75 15.3512 8.30898 14.525 9.16328 14.184L18.5816 10.4188C18.8488 10.3098 19.1477 10.3098 19.4184 10.4188L28.8367 14.184C29.691 14.525 30.25 15.3547 30.25 16.2723V27.4063C30.25 27.8739 29.8738 28.25 29.4062 28.25H27.7188C27.2512 28.25 26.875 27.8739 26.875 27.4063V18.125C26.875 17.5028 26.3723 17 25.75 17H12.25C11.6277 17 11.125 17.5028 11.125 18.125V27.4063C11.125 27.8739 10.7488 28.25 10.2812 28.25H8.59375C8.12617 28.25 7.75 27.8739 7.75 27.4063ZM24.9062 28.25H13.0938C12.6262 28.25 12.25 27.8739 12.25 27.4063V25.4375H25.75V27.4063C25.75 27.8739 25.3738 28.25 24.9062 28.25ZM12.25 24.3125V22.0625H25.75V24.3125H12.25ZM12.25 20.9375V18.125H25.75V20.9375H12.25Z" fill="white" scaleX="1.3" scaleY="1.3" />
                </Group>
                <VBox>
                    <Label styleClass="app-title" text="StockFlow">
                        <font>
                            <Font name="System Bold" size="20.0" />
                        </font>
                    </Label>
                    <Label styleClass="app-subtitle" text="Warehouse Management">
                        <font>
                            <Font size="16.0" />
                        </font>
                    </Label>
                </VBox>
            </HBox>

            <!-- Spacer -->
            <Region HBox.hgrow="ALWAYS" />

            <!-- Notification and Settings -->
            <HBox spacing="12" alignment="CENTER">
                <StackPane styleClass="icon-button">
                    <Label text="🔔" styleClass="icon">
                        <font>
                            <Font size="20" />
                        </font>
                    </Label>
                </StackPane>
                <StackPane styleClass="icon-button">
                    <Label text="⚙" styleClass="icon">
                        <font>
                            <Font size="20" />
                        </font>
                    </Label>
                </StackPane>
            </HBox>
        </HBox>
    </top>

    <!-- Sidebar -->
    <left>
        <VBox minWidth="200" prefWidth="200" spacing="8" styleClass="sidebar">
            <padding>
                <Insets bottom="20" left="12" right="12" top="20" />
            </padding>

            <!-- User Profile -->
            <HBox alignment="CENTER_LEFT" spacing="12" styleClass="user-profile">
                <padding>
                    <Insets bottom="12" left="12" right="12" top="12" />
                </padding>
                <Label styleClass="user-icon" text="👤">
                    <font>
                        <Font size="24" />
                    </font>
                </Label>
                <VBox>
                    <Label fx:id="staffNameLabel" styleClass="user-name" text="Yanto">
                        <font>
                            <Font name="System Bold" size="16.0" />
                        </font>
                    </Label>
                    <Label styleClass="user-role-staff" text="Staff">
                        <font>
                            <Font size="13.0" />
                        </font>
                    </Label>
                </VBox>
            </HBox>

            <!-- Navigation Menu -->
            <VBox spacing="4" VBox.vgrow="NEVER">
                <padding>
                    <Insets top="12" />
                </padding>

                <!-- Transaksi Masuk (Inbound) - Active -->
                <Button alignment="CENTER_LEFT" maxWidth="Infinity" styleClass="nav-button, nav-button-active" text="⬇  Transaksi Masuk" onAction="#navigateToInbound">
                    <padding>
                        <Insets bottom="12" left="16" right="12" top="12" />
                    </padding>
                    <font>
                        <Font size="14" />
                    </font>
                </Button>

                <!-- Transaksi Keluar (Outbound) -->
                <Button alignment="CENTER_LEFT" maxWidth="Infinity" styleClass="nav-button" text="⬆  Transaksi Keluar" onAction="#navigateToOutbound">
                    <padding>
                        <Insets bottom="12" left="16" right="12" top="12" />
                    </padding>
                    <font>
                        <Font size="14" />
                    </font>
                </Button>

                <!-- Inventory -->
                <Button alignment="CENTER_LEFT" maxWidth="Infinity" styleClass="nav-button" text="📦  Inventory" onAction="#navigateToInventory">
                    <padding>
                        <Insets bottom="12" left="16" right="12" top="12" />
                    </padding>
                    <font>
                        <Font size="14" />
                    </font>
                </Button>

                <!-- Reports -->
                <Button alignment="CENTER_LEFT" maxWidth="Infinity" styleClass="nav-button" text="📊  Reports" onAction="#navigateToReports">
                    <padding>
                        <Insets bottom="12" left="16" right="12" top="12" />
                    </padding>
                    <font>
                        <Font size="14" />
                    </font>
                </Button>
            </VBox>

            <!-- Spacer -->
            <Region VBox.vgrow="ALWAYS" />

            <!-- Logout Button -->
            <Button alignment="CENTER_LEFT" maxWidth="Infinity" styleClass="logout-button" text="⎋ Logout" onAction="#handleLogout">
                <padding>
                    <Insets bottom="12" left="12" right="12" top="12" />
                </padding>
            </Button>
        </VBox>
    </left>

    <!-- Main Content -->
    <center>
        <ScrollPane fitToHeight="true" fitToWidth="true" styleClass="content-scroll">
            <VBox spacing="24" styleClass="main-content">
                <padding>
                    <Insets bottom="32" left="32" right="32" top="32" />
                </padding>

                <!-- Header Section -->
                <VBox spacing="4">
                    <Label styleClass="page-title" text="Transaksi Masuk">
                        <font>
                            <Font name="System Bold" size="28.0" />
                        </font>
                    </Label>
                    <Label styleClass="page-subtitle" text="Kelola barang yang masuk ke warehouse">
                        <font>
                            <Font size="16.0" />
                        </font>
                    </Label>
                </VBox>

                <!-- Stats Cards Grid -->
                <GridPane hgap="20" styleClass="stats-grid" vgap="20">
                    <columnConstraints>
                        <ColumnConstraints minWidth="200" hgrow="ALWAYS" />
                        <ColumnConstraints minWidth="200" hgrow="ALWAYS" />
                        <ColumnConstraints minWidth="200" hgrow="ALWAYS" />
                        <ColumnConstraints minWidth="200" hgrow="ALWAYS" />
                    </columnConstraints>

                    <!-- Total Masuk Hari Ini -->
                    <HBox alignment="CENTER_LEFT" spacing="16" styleClass="stat-card" GridPane.columnIndex="0">
                        <padding>
                            <Insets bottom="20" left="20" right="20" top="20" />
                        </padding>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-label" text="Total Masuk Hari Ini">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                            <Label fx:id="todayInboundLabel" styleClass="stat-value" text="127">
                                <font>
                                    <Font name="System Bold" size="32.0" />
                                </font>
                            </Label>
                        </VBox>
                        <Label styleClass="stat-icon-green" text="⬇">
                            <font>
                                <Font size="28" />
                            </font>
                        </Label>
                    </HBox>

                    <!-- Nilai Total -->
                    <HBox alignment="CENTER_LEFT" spacing="16" styleClass="stat-card" GridPane.columnIndex="1">
                        <padding>
                            <Insets bottom="20" left="20" right="20" top="20" />
                        </padding>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-label" text="Nilai Total">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                            <Label fx:id="totalValueLabel" styleClass="stat-value" text="Rp 45.2M">
                                <font>
                                    <Font name="System Bold" size="32.0" />
                                </font>
                            </Label>
                        </VBox>
                        <Label styleClass="stat-icon-blue" text="💰">
                            <font>
                                <Font size="28" />
                            </font>
                        </Label>
                    </HBox>

                    <!-- Pending Review -->
                    <HBox alignment="CENTER_LEFT" spacing="16" styleClass="stat-card" GridPane.columnIndex="2">
                        <padding>
                            <Insets bottom="20" left="20" right="20" top="20" />
                        </padding>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-label" text="Pending Review">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                            <Label fx:id="pendingLabel" styleClass="stat-value" text="8">
                                <font>
                                    <Font name="System Bold" size="32.0" />
                                </font>
                            </Label>
                        </VBox>
                        <Label styleClass="stat-icon-warning" text="⏱">
                            <font>
                                <Font size="28" />
                            </font>
                        </Label>
                    </HBox>

                    <!-- Suppliers Aktif -->
                    <HBox alignment="CENTER_LEFT" spacing="16" styleClass="stat-card" GridPane.columnIndex="3">
                        <padding>
                            <Insets bottom="20" left="20" right="20" top="20" />
                        </padding>
                        <VBox spacing="4" HBox.hgrow="ALWAYS">
                            <Label styleClass="stat-label" text="Suppliers Aktif">
                                <font>
                                    <Font size="13.0" />
                                </font>
                            </Label>
                            <Label fx:id="suppliersLabel" styleClass="stat-value" text="23">
                                <font>
                                    <Font name="System Bold" size="32.0" />
                                </font>
                            </Label>
                        </VBox>
                        <Label styleClass="stat-icon-purple" text="🚚">
                            <font>
                                <Font size="28" />
                            </font>
                        </Label>
                    </HBox>

                    <rowConstraints>
                        <RowConstraints />
                    </rowConstraints>
                </GridPane>

                <!-- Transaction Form -->
                <VBox spacing="20" styleClass="form-container">
                    <padding>
                        <Insets bottom="24" left="24" right="24" top="24" />
                    </padding>

                    <HBox alignment="CENTER_LEFT">
                        <Label text="Form Transaksi Masuk" styleClass="form-title">
                            <font>
                                <Font name="System Bold" size="20" />
                            </font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <Button text="+ Tambah Transaksi" styleClass="add-button" onAction="#handleAddTransaction">
                            <font>
                                <Font name="System Bold" size="14" />
                            </font>
                        </Button>
                    </HBox>

                    <!-- Transaction Type Selection -->
                    <VBox spacing="12">
                        <Label text="Tipe Transaksi" styleClass="field-label">
                            <font>
                                <Font name="System Bold" size="14" />
                            </font>
                        </Label>
                        <HBox spacing="20">
                            <RadioButton fx:id="inboundRadio" text="Inbound (Masuk dari Supplier)" styleClass="radio-button" selected="true" onAction="#handleTransactionTypeChange">
                                <toggleGroup>
                                    <ToggleGroup fx:id="transactionTypeGroup" />
                                </toggleGroup>
                                <font>
                                    <Font size="14" />
                                </font>
                            </RadioButton>
                            <RadioButton fx:id="outboundRadio" text="Outbound (Keluar ke Toko)" styleClass="radio-button" toggleGroup="$transactionTypeGroup" onAction="#handleTransactionTypeChange">
                                <font>
                                    <Font size="14" />
                                </font>
                            </RadioButton>
                        </HBox>
                    </VBox>

                    <!-- Form Fields Grid -->
                    <GridPane hgap="20" vgap="16">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50" />
                            <ColumnConstraints percentWidth="50" />
                        </columnConstraints>

                        <!-- Product SKU -->
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Product SKU" styleClass="field-label">
                                <font>
                                    <Font size="14" />
                                </font>
                            </Label>
                            <ComboBox fx:id="productSKUCombo" promptText="Pilih Product SKU" styleClass="form-input" maxWidth="Infinity">
                                <items>
                                    <javafx.collections.FXCollections fx:factory="observableArrayList">
                                        <String fx:value="LAPTOP-DELL-XPS" />
                                        <String fx:value="CHAIR-HERMAN-MILLER" />
                                        <String fx:value="DESK-IKEA-001" />
                                    </javafx.collections.FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>

                        <!-- Date -->
                        <VBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Tanggal" styleClass="field-label">
                                <font>
                                    <Font size="14" />
                                </font>
                            </Label>
                            <DatePicker fx:id="transactionDatePicker" promptText="DD/MM/YYYY" styleClass="form-input" maxWidth="Infinity" />
                        </VBox>

                        <!-- Supplier/Customer (conditional label) -->
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label fx:id="supplierLabel" text="Supplier" styleClass="field-label">
                                <font>
                                    <Font size="14" />
                                </font>
                            </Label>
                            <ComboBox fx:id="supplierCombo" promptText="Pilih Supplier" styleClass="form-input" maxWidth="Infinity">
                                <items>
                                    <javafx.collections.FXCollections fx:factory="observableArrayList">
                                        <String fx:value="PT Maju Jaya" />
                                        <String fx:value="CV Berkah" />
                                        <String fx:value="UD Sentosa" />
                                    </javafx.collections.FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>

                        <!-- Shipping Method -->
                        <VBox spacing="8" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label text="Metode Pengiriman" styleClass="field-label">
                                <font>
                                    <Font size="14" />
                                </font>
                            </Label>
                            <ComboBox fx:id="shippingMethodCombo" promptText="Pilih Metode" styleClass="form-input" maxWidth="Infinity">
                                <items>
                                    <javafx.collections.FXCollections fx:factory="observableArrayList">
                                        <String fx:value="standard ground" />
                                        <String fx:value="express air" />
                                        <String fx:value="sea freight" />
                                    </javafx.collections.FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>

                        <!-- Quantity -->
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="2">
                            <Label text="Kuantitas" styleClass="field-label">
                                <font>
                                    <Font size="14" />
                                </font>
                            </Label>
                            <TextField fx:id="quantityField" promptText="Masukkan kuantitas" styleClass="form-input">
                                <font>
                                    <Font size="14" />
                                </font>
                            </TextField>
                        </VBox>

                        <!-- Destination Address (only for outbound) -->
                        <VBox fx:id="addressContainer" spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="3" GridPane.columnSpan="2" managed="false" visible="false">
                            <Label text="Alamat Tujuan" styleClass="field-label">
                                <font>
                                    <Font size="14" />
                                </font>
                            </Label>
                            <TextArea fx:id="destinationAddressArea" promptText="Masukkan alamat lengkap tujuan pengiriman" styleClass="form-textarea" prefRowCount="3" wrapText="true">
                                <font>
                                    <Font size="14" />
                                </font>
                            </TextArea>
                        </VBox>

                        <rowConstraints>
                            <RowConstraints />
                            <RowConstraints />
                            <RowConstraints />
                            <RowConstraints />
                        </rowConstraints>
                    </GridPane>

                    <!-- Action Buttons -->
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Button text="💾  Simpan Transaksi" styleClass="submit-button" onAction="#handleSubmit">
                            <font>
                                <Font name="System Bold" size="14" />
                            </font>
                            <padding>
                                <Insets top="12" right="24" bottom="12" left="24" />
                            </padding>
                        </Button>
                        <Button text="↻  Reset Form" styleClass="reset-button" onAction="#handleReset">
                            <font>
                                <Font size="14" />
                            </font>
                            <padding>
                                <Insets top="12" right="24" bottom="12" left="24" />
                            </padding>
                        </Button>
                    </HBox>
                </VBox>

                <!-- Recent Transactions Table -->
                <VBox spacing="16" styleClass="table-container">
                    <padding>
                        <Insets bottom="24" left="24" right="24" top="24" />
                    </padding>

                    <Label text="Transaksi Terbaru" styleClass="section-title">
                        <font>
                            <Font name="System Bold" size="20" />
                        </font>
                    </Label>

                    <TableView fx:id="transactionsTable" styleClass="transactions-table" VBox.vgrow="ALWAYS">
                        <columns>
                            <TableColumn text="ID" prefWidth="80" styleClass="table-column" fx:id="idColumn" />
                            <TableColumn text="Nama Barang" prefWidth="150" styleClass="table-column" fx:id="productNameColumn" />
                            <TableColumn text="Brand" prefWidth="120" styleClass="table-column" fx:id="brandColumn" />
                            <TableColumn text="Supplier" prefWidth="120" styleClass="table-column" fx:id="supplierColumn" />
                            <TableColumn text="Qty" prefWidth="60" styleClass="table-column" fx:id="qtyColumn" />
                            <TableColumn text="Harga" prefWidth="120" styleClass="table-column" fx:id="priceColumn" />
                            <TableColumn text="Status" prefWidth="100" styleClass="table-column" fx:id="statusColumn" />
                        </columns>
                    </TableView>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>